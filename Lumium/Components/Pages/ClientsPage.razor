@page "/clients"
@using Lumium.Models
@using MudBlazor

<MudText Typo="Typo.h5" Class="mb-2">Clients Table</MudText>

<MudStack Row="true" AlignItems="AlignItems.Center" Class="mb-4" Justify="Justify.FlexStart">
    <MudTextField Style="width: 400px"
                  @bind-Value="_searchString" 
                  Placeholder="Search by Name or Email..." 
                  Adornment="Adornment.Start" 
                  AdornmentIcon="@Icons.Material.Filled.Search" />
    <MudButton Variant="Variant.Filled" 
               Color="Color.Primary" 
               StartIcon="@Icons.Material.Filled.Add"
               OnClick="@OpenAddClientDialog">
        Add New Client
    </MudButton>
</MudStack>

<MudTable Items="@FilteredClients" Hover="true" Striped="true" Bordered="true" Elevation="1" FixedHeader="true" RowsPerPage="5">
    <HeaderContent>
        <MudTh><MudTableSortLabel SortBy="new Func<Client, object>(x=>x.Id)">Id</MudTableSortLabel></MudTh>
        <MudTh><MudTableSortLabel SortBy="new Func<Client, object>(x=>x.Name)">Name</MudTableSortLabel></MudTh>
        <MudTh><MudTableSortLabel SortBy="new Func<Client, object>(x=>x.Email)">Email</MudTableSortLabel></MudTh>
        <MudTh Style="width: 60px;">Edit</MudTh>
        <MudTh Style="width: 60px;">Delete</MudTh>
    </HeaderContent>
    <RowTemplate>
        <MudTd DataLabel="ID">@context.Id</MudTd>
        <MudTd DataLabel="Name">@context.Name</MudTd>
        <MudTd DataLabel="Email">@context.Email</MudTd>
        <MudTd>
            <MudIconButton Icon="@Icons.Material.Filled.Edit" 
                           Color="Color.Primary" 
                           Size="Size.Small"
                           OnClick="@(async () => await EditClient(context))" />
        </MudTd>
        <MudTd>
            <MudIconButton Icon="@Icons.Material.Filled.Delete" 
                           Color="Color.Primary" 
                           Size="Size.Small"
                           OnClick="@(async () => await DeleteClient(context))" />
        </MudTd>
    </RowTemplate>
    <PagerContent>
        <MudTablePager />
    </PagerContent>
</MudTable>
