@page "/login-user"
@inject NavigationManager Navigation

<MudContainer MaxWidth="MaxWidth.Small" Class="mt-16">
    <MudPaper Elevation="4" Class="pa-8">
        <MudStack Spacing="2" Class="mb-6">
            <MudButton
                StartIcon="@Icons.Material.Filled.ArrowBack"
                Variant="Variant.Text"
                Color="Color.Default"
                Size="Size.Small"
                OnClick="@GoBack">
                Promeni kompaniju
            </MudButton>

            <MudText Typo="Typo.h5" Align="Align.Center">
                Uloguj se na @_tenantName
            </MudText>
        </MudStack>

        <MudForm @ref="_form" @bind-IsValid="_isValid">
            <MudTextField
                @bind-Value="_email"
                Label="Email"
                Variant="Variant.Outlined"
                Adornment="Adornment.Start"
                AdornmentIcon="@Icons.Material.Filled.Email"
                Required="true"
                RequiredError="Email je obavezan!"
                Validation="@(new Func<string, string?>(ValidateEmail))"
                Class="mb-4"/>

            <MudTextField
                @bind-Value="_password"
                Label="Lozinka"
                Variant="Variant.Outlined"
                InputType="InputType.Password"
                Adornment="Adornment.Start"
                AdornmentIcon="@Icons.Material.Filled.Lock"
                Required="true"
                RequiredError="Lozinka je obavezna!"
                Class="mb-4"/>

            @if (!string.IsNullOrEmpty(_errorMessage))
            {
                <MudAlert Severity="Severity.Error" Class="mb-4">
                    @_errorMessage
                </MudAlert>
            }

            <MudButton
                Variant="Variant.Filled"
                Color="Color.Primary"
                FullWidth="true"
                Size="Size.Large"
                OnClick="@HandleLogin"
                Disabled="!_isValid || _isLoading">
                @if (_isLoading)
                {
                    <MudProgressCircular Size="Size.Small" Indeterminate="true"/>
                    <MudText Class="ml-2">Prijavljivanje...</MudText>
                }
                else
                {
                    <span>Prijavi se</span>
                }
            </MudButton>
        </MudForm>
    </MudPaper>
</MudContainer>